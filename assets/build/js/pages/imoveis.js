function init(){$filtros={},$scroll=!0,$page=1,locations=[],imoveisHtml=[],$precoMinimo="",$precoMaximo="",$areaMinimo="",$areaMaximo="",$postVars=ajaxapi.post,$ordenacao="",$imoveisTotais=0,postVars(),configFilters(),getImoveis(),initMap(),loadMoreBtn(),onScroll()}function onScroll(){$(document).on("scroll",(function(){$(document).scrollTop()>80&&$(document).scrollTop()<370?$(".col-right").removeClass("fixed-bottom").addClass("fixed"):$(document).scrollTop()>370?$(".col-right").removeClass("fixed").addClass("fixed-bottom"):$(".col-right").removeClass("fixed fixed-bottom")}))}function postVars(){$postVars&&$postVars.length>0&&toogleFiltered(!0)}function configFilters(){$(".filters .filter").each((function(){$(this).find("> button").on("click",(function(){$(this).parent().hasClass("opened")?($(".filters .filter").removeClass("opened"),$(".filters").css({"overflow-x":"scroll"})):($(".filters .filter").removeClass("opened"),$(this).parent().addClass("opened"),$(".filters").css("overflow","visible"))})),$(this).find(".btn-aplicar").on("click",(function(){$(this).parents(".filter").hasClass("valid")&&$(this).parents(".filter").removeClass("opened").addClass("active")})),$(this).find(".btn-limpar").on("click",(function(){$(this).parents(".filter").removeClass("active opened valid")}))})),configFilterValue(),configFilterSize(),configFilterQuartos(),configFilterVagas(),configFilterOrdenar(),resetFilters()}function configFilterValue(){function a(a){var e=a.split(",");$precoMinimo=e[0],$precoMaximo=e[1],$(".filter-valor .range-header .range-min span").html(parseInt(e[0]).toLocaleString("pt-BR")),$(".filter-valor .range-header .range-max span").html(parseInt(e[1]).toLocaleString("pt-BR")),$(".filter-valor .value").html("R$ "+parseInt(e[1]).toLocaleString("pt-BR")),$(".filter-valor").addClass("valid")}function e(){$(".filter-valor").addClass("active"),$filtros.precoMinimo=$precoMinimo,$filtros.precoMaximo=$precoMaximo}$(".filter-valor .range-value").jRange({from:7e4,to:3e6,step:500,format:"R$ %s",showLabels:!1,showScale:!1,theme:"theme-blue",isRange:!0,onstatechange:function(e){a(e)}}),$postVars.valor&&"70000,3000000"!=$postVars.valor&&(a($postVars.valor),$(".filter-valor .range-value").jRange("setValue",$postVars.valor),e()),$(".filter-valor .btn-limpar").on("click",(function(){$(".filter-valor .range-value").jRange("setValue","70000,3000000"),delete $filtros.precoMinimo,delete $filtros.precoMaximo,submitFilters()})),$(".filter-valor .btn-aplicar").on("click",(function(a){$(".filter-valor").hasClass("valid")&&(e(),submitFilters())}))}function configFilterSize(){$(".filter-tamanho .range-size").jRange({from:20,to:300,step:5,format:"%s m2",showLabels:!1,showScale:!1,theme:"theme-blue",isRange:!0,onstatechange:function(a){!function(a){var e=a.split(",");$areaMinimo=e[0],$areaMaximo=e[1],$(".filter-tamanho .range-header .range-min span").html($areaMinimo),$(".filter-tamanho .range-header .range-max span").html($areaMaximo),$(".filter-tamanho .value").html($areaMaximo+"m2"),$(".filter-tamanho").addClass("valid")}(a)}}),$(".filter-tamanho .btn-limpar").on("click",(function(){$(".filter-tamanho .range-size").jRange("setValue","20,300"),delete $filtros.areaPrivativaMinimo,delete $filtros.areaPrivativaMaximo,submitFilters()})),$(".filter-tamanho .btn-aplicar").on("click",(function(){$(".filter-tamanho").hasClass("valid")&&($(".filter-tamanho").addClass("active"),$filtros.areaPrivativaMinimo=$areaMinimo,$filtros.areaPrivativaMaximo=$areaMaximo,submitFilters())}))}function configFilterQuartos(){function a(a){$quartosMinimo=a,$quartosMaximo=4==a?"100":a,a>1?$(".filter-quartos .value").html($quartosMinimo+" quartos"):1==a&&$(".filter-quartos .value").html($quartosMinimo+" quarto"),$(".filter-quartos").addClass("valid")}function e(){$(".filter-quartos").addClass("active"),$filtros.quartosMinimo=$quartosMinimo,$filtros.quartosMaximo=$quartosMaximo}$postVars.quartos&&(a($postVars.quartos),$(".filter-quartos").find('[name="quartos"][value='+$postVars.quartos+"]").attr("checked","checked"),e()),$(".filter-quartos .btn-limpar").on("click",(function(){$('.filter-quartos [name="quartos"]').prop("checked",!1),delete $filtros.quartosMinimo,delete $filtros.quartosMaximo,submitFilters()})),$(".filter-quartos .btn-aplicar").on("click",(function(){$(".filter-quartos").find('[name="quartos"]:checked').val()&&(a($(".filter-quartos").find('[name="quartos"]:checked').val()),$(".filter-quartos").hasClass("valid")&&(e(),submitFilters()))}))}function configFilterVagas(){function a(a){$vagasMinimo=a,$vagasMaximo=3==a?"100":a,a>1?$(".filter-vagas .value").html($vagasMinimo+" vagas"):1==a?$(".filter-vagas .value").html($vagasMinimo+" vaga"):0==a&&$(".filter-vagas .value").html("Sem vagas"),$(".filter-vagas").addClass("valid")}function e(){$(".filter-vagas").addClass("active"),$filtros.garagensMinimo=$vagasMinimo,$filtros.garagensMaximo=$vagasMaximo}$postVars.vagas&&(a($postVars.vagas),$(".filter-vagas").find('[name="vagas"][value='+$postVars.vagas+"]").attr("checked","checked"),e()),$(".filter-vagas .btn-limpar").on("click",(function(){$('.filter-vagas [name="vagas"]').prop("checked",!1),delete $filtros.garagensMinimo,delete $filtros.garagensMaximo,submitFilters()})),$(".filter-vagas .btn-aplicar").on("click",(function(){$(".filter-vagas").find('[name="vagas"]:checked').val()&&(a($(".filter-vagas").find('[name="vagas"]:checked').val()),$(".filter-vagas").hasClass("valid")&&(e(),submitFilters()))}))}function configFilterOrdenar(){$(".filter-ordenacao .dropdown-item").on("click",(function(){var a,e;a=$(this),e=a,$ordenacao=e.data("value"),$(".filter-ordenacao .btn").html(e.html()),$filtros.ordenacao=$ordenacao,resetConfig(),getImoveis()}))}function resetConfig(){$page=1,delete $filtros.paginado,delete $filtros.startpag,locations=[],imoveisHtml=[],$(".imoveis-list .imoveis .imoveis-row").html("")}function resetFilters(){$("[data-filtered]").on("click",(function(){$filtros={},$ordenacao?$filtros.ordenacao=$ordenacao:delete $filtros.ordenacao,$('.filter-vagas [name="vagas"]').prop("checked",!1),$('.filter-quartos [name="quartos"]').prop("checked",!1),$(".filter-tamanho .range-size").jRange("setValue","20,300"),$(".filter-valor .range-value").jRange("setValue","70000,3000000"),$(".filters .filter").removeClass("opened active valid"),toogleFiltered(!1),resetConfig(),getImoveis()}))}function submitFilters(){resetConfig(),toogleFiltered(!0),getImoveis(),initMap()}function toogleFiltered(a){a?$("[data-filtered]").addClass("active"):$("[data-filtered]").removeClass("active")}function toogleTotalImoveis(a){a?$("[data-total]").addClass("active"):$("[data-total]").removeClass("active")}function toogleError(a,e){a?($("[data-error]").addClass("active"),$("[data-error]").html(e)):$("[data-error]").removeClass("active")}function toogleLoader(a){a?$("[data-loader]").addClass("active"):$("[data-loader]").removeClass("active")}function getImoveis(a){console.log("AjaxAPI >>>>>",ajaxapi),$.ajax({url:ajaxapi.ajaxurl,type:"post",data:{action:"get_estabelecimentos",query_vars:ajaxapi.query_vars,get:ajaxapi.get,post:ajaxapi.post,query:ajaxapi.query,filters:$filtros,page:$page},beforeSend:function(){toogleError(!1),a||toogleTotalImoveis(!1),toogleLoader(!0),toogleLoadMoreBtn(!1)},success:function(e){$imoveisTotais=e.total,$imoveisCarregadosTotais=e.imoveis.length,$i=0,toogleTotalImoveis(!0),toogleLoadMoreBtn(!0);var o=e.html,t=e.imoveis;console.log("Imoveis",t),t.forEach((a,e)=>{if(a.lat&&a.lng){let t={lat:a.lat,lng:a.lng};locations.push(t),imoveisHtml.push(o[e])}}),initMap(),toogleLoader(!1),1==$imoveisTotais?$(".listItemTotal [data-total]").html('Achamos <strong class="totalImoveis">'+$imoveisTotais+"</strong> imóvel com essas características"):(0==$imoveisTotais||$imoveisTotais>1)&&$(".listItemTotal [data-total]").html('Achamos <strong class="totalImoveis">'+$imoveisTotais+"</strong> imóveis com essas características"),$imoveisTotais>0?$(".imoveis-blank").removeClass("show"):$(".imoveis-blank").addClass("show"),$(".imoveis-list .imoveis #loader, .imoveis-list .imoveis #error").remove(),$(".imoveis-list .imoveis .imoveis-row").append(e.html),$(window).width()>991&&$(".col-left .imoveis .imoveis-container").mCustomScrollbar({theme:"ang",mouseWheel:{enable:!0,preventDefault:!1},scrollInertia:1e5,scrollbarPosition:"outside",callbacks:{onTotalScroll:function(){loadMore()}}}),a?slickImovelCard(!0):slickImovelCard()},error:function(a,e,o){$(".imoveis-list .imoveis #loader").remove(),toogleLoader(!1),toogleError(!0,a.responseText)}})}function loadMore(){$page<$imoveisTotais&&$(".imoveis .imoveis-row > div").length<$imoveisTotais?($page+=1,getImoveis(!0)):toogleLoadMoreBtn(!1)}function initMap(){var a=new google.maps.Map(document.getElementById("map"),{zoom:14,center:{lat:-8.06094,lng:-34.8801875},mapTypeControl:!1,streetViewControl:!1,rotateControl:!1}),e=new google.maps.InfoWindow,o=locations.map((function(o,t){var i=t,s=new google.maps.Marker({position:o,icon:ajaxapi.assets+"/img/layout/m2.png",label:{text:"1",textSize:13,fontFamily:"ITC Avant Garde Gothic",fontWeight:"bold",color:"white"}});return google.maps.event.addListener(s,"click",(function(o){e.setContent(imoveisHtml[i]),e.open(a,s)})),s}));new MarkerClusterer(a,o,{styles:[{url:ajaxapi.assets+"/img/layout/m1.png",width:53,height:53,fontFamily:"ITC Avant Garde Gothic",textSize:15,textColor:"white"}]})}function slickImovelCard(a){$(window).width()>991&&(a?($(".slick-slider").slick("unslick"),slickImovelCard()):($("[data-imovelcard-slick]").slick({infinite:!1,autoplay:!1,slidesToShow:1,pauseOnHover:!1,pauseOnFocus:!1,arrows:!0,dots:!0,swipe:!1}),$("[data-imovelcard-slick]").find(".slick-dots").on("click",(function(a){a.preventDefault()})),$("[data-imovelcard-slick]").find(".slick-arrow").on("click",(function(a){a.preventDefault()}))))}function loadMoreBtn(){$("[data-loadmorebtn]").on("click",(function(a){a.preventDefault(),loadMore()}))}function toogleLoadMoreBtn(a){a?$("[data-loadmorebtn]").removeClass("d-none").addClass("d-block"):$("[data-loadmorebtn]").removeClass("d-block").addClass("d-none")}